<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Eternal Brothers FC</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js"></script>

<style>
body {
    font-family: "Cairo", Arial, sans-serif;
    background-color: #121212;
    background-image: url('team-logo.jpg');
    background-repeat: no-repeat;
    background-position: center top;
    background-size: 200px;
    color: #e0e0e0;
    padding: 20px;
    text-align: center;
}
.container {
    max-width: 650px;
    margin: auto;
    background: #1e1e1ecc;
    padding: 35px 25px;
    border-radius: 15px;
    box-shadow: 0 0 15px #000;
    display: none;
}
h1 { font-size: 32px; color: #fff; margin-bottom: 15px; font-weight: 700; }
h2 { font-size: 24px; color: #fff; margin: 20px 0 10px; }
.match-time { font-weight: 600; color: #bbbbbb; margin-bottom: 25px; font-size: 18px; }
label { font-weight: 600; display: block; margin: 15px 0 10px 0; font-size: 18px; color: #fff; }
input[type=text] { padding: 12px; width: 75%; margin: 10px 0 20px 0; border-radius: 8px; border: 1px solid #555; text-align: center; font-size: 16px; background-color: #2c2c2c; color: #fff; }
button { padding: 12px 18px; border: none; border-radius: 8px; cursor: pointer; margin: 10px 8px; font-size: 16px; font-weight: 600; transition: 0.2s; }
button:hover { opacity: 0.9; }
ul { list-style: none; padding: 0; text-align: left; margin-top: 20px; }
li { background: #2c2c2c; margin: 10px 0; padding: 12px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; font-size: 16px; font-weight: 500; color: #e0e0e0; }
.actions button { background-color: #555; margin-left: 6px; padding: 6px 10px; font-size: 14px; color: #fff; }
.actions button:hover { background-color: #333; }
.nav-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 30px 0;
}
.nav-buttons button {
    color: #fff;
    font-weight: 600;
}
#homeBtn { background-color: #d32f2f; }
#blueBtn { background-color: #1976d2; }
#yellowBtn { background-color: #fbc02d; color: #000; }
.nav-buttons button span { margin-right: 6px; }
#chatBox { max-height: 300px; overflow-y: auto; background:#2c2c2c; padding:10px; border-radius:8px; margin-bottom:10px; text-align: left; }
#chatInput { padding:10px; width:70%; border-radius:6px; border:1px solid #555; background:#1e1e1e; color:#fff; }
#clearChatBtn { background:#d32f2f; margin-top:5px; }
</style>
</head>
<body>

<div class="nav-buttons">
    <button id="blueBtn" onclick="showSection('blue')"><span>üîµ</span>Blue Team</button>
    <button id="homeBtn" onclick="showSection('main')"><span>üè†</span>Main Team</button>
    <button id="yellowBtn" onclick="showSection('yellow')"><span>üü°</span>Yellow Team</button>
</div>

<!-- Main Team -->
<div id="main" class="container">
    <h1>‚öΩ Eternal Brothers FC </h1>
    <div class="match-time">The match will be on Sunday at 9:40 AM</div>

    <label>Match Location:</label>
    <input type="text" id="matchLocation" placeholder="Enter location here">

    <input type="text" id="nameInput" placeholder="Enter your name">
    <button onclick="addMember()">Add</button>

    <h2>Main Team List (24 players max):</h2>
    <ul id="teamList"></ul>

    <h2>Waiting List:</h2>
    <ul id="waitingList"></ul>

    <h2>Team Chat</h2>
    <div id="chatBox"></div>
    <input type="text" id="chatInput" placeholder="Type your message...">
    <button onclick="sendMessage()">Send</button>
    <button id="clearChatBtn" onclick="clearChat()">Clear Chat</button>
</div>

<!-- Blue Team -->
<div id="blue" class="container">
    <h2>üîµ Blue Team</h2>
    <input type="text" id="blueInput" placeholder="Enter player name">
    <button onclick="addBlue()">Add</button>
    <ul id="blueList"></ul>
</div>

<!-- Yellow Team -->
<div id="yellow" class="container">
    <h2>üü° Yellow Team</h2>
    <input type="text" id="yellowInput" placeholder="Enter player name">
    <button onclick="addYellow()">Add</button>
    <ul id="yellowList"></ul>
</div>

<script type="module">
// Firebase Imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js";

// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyAPB2dHdpBwIvPBpkFlu9EbRwbdswV7iI8",
  authDomain: "eternal-brothers-fc.firebaseapp.com",
  projectId: "eternal-brothers-fc",
  storageBucket: "eternal-brothers-fc.firebasestorage.app",
  messagingSenderId: "884144294831",
  appId: "1:884144294831:web:6601570db1f25ebac77d5a",
  measurementId: "G-54F4M68EFN"
};

// Initialize Firebase & Firestore
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ------------------ UI Logic ------------------
function showSection(id){
    document.querySelectorAll('.container').forEach(c=>c.style.display='none');
    document.getElementById(id).style.display='block';
}
showSection('main');

// ------------------ Data Variables ------------------
let team = [];
let waiting = [];
let blueTeam = [];
let yellowTeam = [];
const maxTeamSize = 24;
const maxBlue = 12;
const maxYellow = 12;

// ------------------ Firestore Functions ------------------
async function loadAll(){
    await loadList("mainTeam","teamList");
    await loadList("waiting","waitingList");
    await loadList("blueTeam","blueList");
    await loadList("yellowTeam","yellowList");
    await loadChat();
}

async function loadList(name,id){
    const ref = doc(db, "teams", name);
    const snap = await getDoc(ref);
    if(snap.exists()){
        const data = snap.data();
        const players = data.players || [];
        if(name==="mainTeam") team = players;
        else if(name==="waiting") waiting = players;
        else if(name==="blueTeam") blueTeam = players;
        else yellowTeam = players;
    }
    renderAll();
}

async function saveList(name,list){
    const ref = doc(db, "teams", name);
    await setDoc(ref, { players: list });
}

// ------------------ Add Members ------------------
async function addMember(){
    const input = document.getElementById('nameInput');
    const name = input.value.trim();
    if(!name) return alert("Name cannot be empty!");
    if(team.includes(name) || waiting.includes(name)) return alert("Already exists!");
    if(team.length<maxTeamSize) team.push(name);
    else waiting.push(name);
    input.value="";
    await saveList("mainTeam",team);
    await saveList("waiting",waiting);
    renderAll();
}

async function addBlue(){
    const input = document.getElementById('blueInput');
    const name = input.value.trim();
    if(!name) return alert("Name cannot be empty!");
    if(blueTeam.includes(name)) return alert("Already exists!");
    if(blueTeam.length>=maxBlue) return alert("Team full!");
    blueTeam.push(name);
    input.value="";
    await saveList("blueTeam",blueTeam);
    renderAll();
}

async function addYellow(){
    const input = document.getElementById('yellowInput');
    const name = input.value.trim();
    if(!name) return alert("Name cannot be empty!");
    if(yellowTeam.includes(name)) return alert("Already exists!");
    if(yellowTeam.length>=maxYellow) return alert("Team full!");
    yellowTeam.push(name);
    input.value="";
    await saveList("yellowTeam",yellowTeam);
    renderAll();
}

// ------------------ Render ------------------
function renderList(id,list,symbol){
    const ul = document.getElementById(id);
    ul.innerHTML = list.map((m,i)=>`
        <li>${i+1}. ${symbol?symbol+' ':''}${m}</li>
    `).join('');
}

function renderAll(){
    renderList("teamList",team);
    renderList("waitingList",waiting);
    renderList("blueList",blueTeam,"üîµ");
    renderList("yellowList",yellowTeam,"üü°");
}

// ------------------ Chat Functions ------------------
const chatRef = doc(db, "teams", "chat"); 

async function loadChat() {
    const snap = await getDoc(chatRef);
    const chatBox = document.getElementById('chatBox');
    chatBox.innerHTML = '';
    if (snap.exists()) {
        const messages = snap.data().messages || [];
        messages.forEach(msg => {
            const div = document.createElement('div');
            div.textContent = `${msg.name}: ${msg.text}`;
            div.style.padding = '6px 4px';
            div.style.borderBottom = '1px solid #444';
            chatBox.appendChild(div);
        });
        chatBox.scrollTop = chatBox.scrollHeight;
    }
}

async function sendMessage() {
    const input = document.getElementById('chatInput');
    const text = input.value.trim();
    if (!text) return;
    const name = document.getElementById('nameInput').value.trim() || "Anonymous";

    const snap = await getDoc(chatRef);
    let messages = [];
    if (snap.exists()) messages = snap.data().messages || [];
    messages.push({ name, text, time: Date.now() });
    await setDoc(chatRef, { messages });
    input.value = "";
    loadChat();
}

async function clearChat() {
    if (!confirm("Are you sure you want to clear the chat?")) return;
    await setDoc(chatRef, { messages: [] });
    document.getElementById('chatBox').innerHTML = '';
}

setInterval(loadChat, 2000);

// Load initial data
loadAll();

</script>
</body>
</html>
